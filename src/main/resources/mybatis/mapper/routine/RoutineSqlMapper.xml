<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ca.gymbackend.routine.mapper.RoutineSqlMapper">

    <select id="findAllWorkout" resultType="com.ca.gymbackend.routine.response.EveryWorkoutList">
    SELECT c.category_name, c.category_id, e.element_id, e.element_name, e.element_picture FROM workout_element e
    INNER JOIN workout_category c
    ON e.category_id = c.category_id
    </select>


    <select id="findWorkoutGuide" resultType="com.ca.gymbackend.routine.response.WorkoutGuideList">
        SELECT 
            we.element_id, 
            we.element_name, 
            we.element_picture, 
            wc.category_name, 
            wg.instruction, 
            wm.memo_content
        FROM workout_element we
        LEFT JOIN workout_category wc ON we.category_id = wc.category_id
        LEFT JOIN workout_guide wg ON wg.element_id = we.element_id
        LEFT JOIN workout_memo wm ON wm.element_id = we.element_id
        WHERE we.element_id = #{id}
    </select>

    <insert id="insertRoutineInfo" parameterType="com.ca.gymbackend.routine.dto.RoutineInfoDto" useGeneratedKeys="true" keyProperty="routineId">
        INSERT INTO routine_info (user_id, routine_name, created_at)
        VALUES (#{userId}, #{routineName}, #{createdAt})
    </insert>

    <insert id="insertWorkoutPlan" parameterType="com.ca.gymbackend.routine.dto.WorkoutPlanDto" useGeneratedKeys="true" keyProperty="planId">
        INSERT INTO workout_plan (routine_id, element_id, created_at)
        VALUES (#{routineId}, #{elementId}, #{createdAt})
    </insert>

    <insert id="insertWorkoutSet" parameterType="map">
        INSERT INTO workout_set (plan_id, kg, reps)
        VALUES (#{planId}, #{set.kg}, #{set.reps})
    </insert>



</mapper>